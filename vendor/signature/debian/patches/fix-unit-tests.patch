diff --git a/tests/derive.rs b/tests/derive.rs
index 70e2dc0..0abd982 100644
--- a/tests/derive.rs
+++ b/tests/derive.rs
@@ -1,6 +1,6 @@
 //! Tests for code generated by `signature_derive`
 
-#![cfg(feature = "derive")]
+#![cfg(all(feature = "derive", feature = "digest"))]
 
 use digest::{generic_array::GenericArray, Digest, OutputSizeUser};
 use hex_literal::hex;
